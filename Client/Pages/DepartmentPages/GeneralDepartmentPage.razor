@using Client.ApplicationStates
@implements IDisposable
@inject DepartmentState departmentState

@if (departmentState.ShowGeneralDepartment)
{
    <Card Border="Border.Primary" Background="Background.Dark" TextColor="TextColor.Light">
        <CardHeader TextColor="TextColor.White50">
            <i class="fa fa-user text-primary"></i>
            General Department
            <CloseButton Class="float-end" onclick="@GeneralDepartmentClicked"></CloseButton>
        </CardHeader>
        <CardBody>
            <Table Class="rounded">
                <TableHeader ThemeContrast="ThemeContrast.Dark">
                    <TableRow>
                        <TableHeaderCell>#</TableHeaderCell>
                        <TableHeaderCell>First Name</TableHeaderCell>
                        <TableHeaderCell>Last Name</TableHeaderCell>
                        <TableHeaderCell>Username</TableHeaderCell>
                    </TableRow>
                </TableHeader>
                <TableBody>
                    <TableRow>
                        <TableRowHeader>1</TableRowHeader>
                        <TableRowCell>Ilyas</TableRowCell>
                        <TableRowCell>Kaya</TableRowCell>
                        <TableRowCell>@@Turkish Delight</TableRowCell>
                    </TableRow>
                    <TableRow>
                        <TableRowHeader>2</TableRowHeader>
                        <TableRowCell>Muse</TableRowCell>
                        <TableRowCell>Yusuf</TableRowCell>
                        <TableRowCell>@@Somalian FinalBoss</TableRowCell>
                    </TableRow>
                    <TableRow>
                        <TableRowHeader>3</TableRowHeader>
                        <TableRowCell>Caius</TableRowCell>
                        <TableRowCell>Matei</TableRowCell>
                        <TableRowCell>@@Romanian Final Boss</TableRowCell>
                    </TableRow>
                </TableBody>
            </Table>
        </CardBody>
        <CardFooter>
            <Form>
                <Button Color="Color.Primary" @onclick="@OpenDialog">Add department</Button>
            </Form>
        </CardFooter>
    </Card>
}

<GeneralDepartmentDialog @ref="generalDepartmentDialog" /> 

@code {
    GeneralDepartmentDialog? generalDepartmentDialog; 
    GeneralDepartmentDTO Department = new();

    protected override void OnInitialized()
    {
        departmentState.GeneralDepartmentAction += StateHasChanged;
    }

    void OpenDialog()
    {
        generalDepartmentDialog?.OpenDialog();
    }

    public void Dispose()
    {
        departmentState.GeneralDepartmentAction -= StateHasChanged;
    }

    private void GeneralDepartmentClicked()
    {
        departmentState.GeneralDepartmentClicked(false);
    }
}